<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì•„ëì–´ ììŒ Â· ëª¨ìŒ Â· ë‹¨ì–´ í•„ê¸° ì—°ìŠµ</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: #f4f4f7;
      color: #111827;
    }

    header {
      padding: 16px 24px;
      background: #1f2937;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      margin: 0;
      font-size: 20px;
    }

    header span {
      font-size: 13px;
      opacity: 0.85;
    }

    .container {
      display: flex;
      gap: 16px;
      padding: 16px;
      height: calc(100vh - 64px);
      max-height: calc(100vh - 64px);
    }

    /* ì™¼ìª½ íŒ¨ë„: ê¸€ì/ë‹¨ì–´ ëª©ë¡ */
    .sidebar {
      width: 280px;
      background: white;
      border-radius: 12px;
      padding: 12px;
      display: flex;
      flex-direction: column;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.04);
    }

    .tab-buttons {
      display: flex;
      gap: 8px;
      margin-bottom: 10px;
    }

    .tab-button {
      flex: 1;
      padding: 8px 0;
      border-radius: 999px;
      border: none;
      font-size: 14px;
      cursor: pointer;
      background: #e5e7eb;
      transition: background 0.15s, color 0.15s;
    }

    .tab-button.active {
      background: #111827;
      color: white;
    }

    .list-title {
      font-size: 13px;
      color: #6b7280;
      margin: 4px 0 8px;
    }

    .letter-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 8px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .letter-card {
      background: #f9fafb;
      border-radius: 10px;
      padding: 6px 4px 4px;
      cursor: pointer;
      border: 1px solid transparent;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: background 0.15s, border-color 0.15s, transform 0.1s;
      text-align: center;
    }

    .letter-card:hover {
      background: #eef2ff;
      transform: translateY(-1px);
    }

    .letter-card.selected {
      border-color: #4f46e5;
      background: #eef2ff;
    }

    .letter-symbol {
      font-size: 24px;
      margin-bottom: 2px;
      font-family: "Noto Naskh Arabic", "Scheherazade New", "Amiri",
        "Times New Roman", serif;
      direction: rtl;
    }

    .letter-name {
      font-size: 11px;
      color: #4b5563;
    }

    /* ì˜¤ë¥¸ìª½ ë©”ì¸ íŒ¨ë„ */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px;
      min-width: 0;
    }

    .info-panel {
      background: white;
      border-radius: 12px;
      padding: 12px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.04);
      gap: 12px;
    }

    .info-left {
      display: flex;
      flex-direction: column;
      gap: 4px;
      flex: 1;
      min-width: 0;
    }

    .info-title {
      font-size: 14px;
      font-weight: 600;
    }

    .info-detail {
      font-size: 13px;
      color: #4b5563;
    }

    .info-example {
      font-size: 12px;
      color: #374151;
    }

    .info-example span {
      font-family: "Noto Naskh Arabic", "Scheherazade New", "Amiri",
        "Times New Roman", serif;
      direction: rtl;
      font-size: 16px;
      margin-right: 4px;
    }

    .info-actions {
      margin-top: 4px;
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }

    .forms-row {
      margin-top: 4px;
      display: flex;
      align-items: center;
      gap: 4px;
      flex-wrap: wrap;
    }

    .form-label {
      font-size: 11px;
      color: #6b7280;
      margin-right: 2px;
    }

    .form-button {
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      font-size: 11px;
      padding: 3px 7px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 3px;
    }

    .form-button .form-glyph {
      font-family: "Noto Naskh Arabic", "Scheherazade New", "Amiri",
        "Times New Roman", serif;
      direction: rtl;
      font-size: 16px;
    }

    .form-button.selected {
      border-color: #4f46e5;
      background: #eef2ff;
    }

    .big-letter {
      font-size: 46px;
      font-family: "Noto Naskh Arabic", "Scheherazade New", "Amiri",
        "Times New Roman", serif;
      direction: rtl;
      padding: 4px 12px;
      border-radius: 10px;
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      flex-shrink: 0;
      min-width: 120px;
      text-align: center;
    }

    .canvas-row {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
      height: 100%;
      min-height: 0;
    }

    .canvas-card {
      background: white;
      border-radius: 12px;
      padding: 10px;
      display: flex;
      flex-direction: column;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.04);
    }

    .canvas-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
      gap: 6px;
    }

    .canvas-title {
      font-size: 13px;
      font-weight: 600;
    }

    .canvas-controls {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: #6b7280;
    }

    .canvas-controls input[type="range"] {
      width: 70px;
    }

    .btn {
      border-radius: 999px;
      border: none;
      padding: 3px 10px;
      font-size: 11px;
      cursor: pointer;
      background: #e5e7eb;
      color: #111827;
      white-space: nowrap;
    }

    .btn:hover {
      background: #d1d5db;
    }

    .canvas-wrapper {
      flex: 1;
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      position: relative;
    }

    canvas {
      display: block;
      width: 100%;
      height: 100%;
      touch-action: none;
    }

    .hint-text {
      font-size: 11px;
      color: #6b7280;
      margin-top: 4px;
    }

    @media (max-width: 960px) {
      .container {
        flex-direction: column;
        height: auto;
        max-height: none;
      }

      .sidebar {
        width: 100%;
        max-height: 220px;
      }

      .canvas-row {
        grid-template-columns: 1fr;
        height: auto;
      }

      .canvas-card {
        height: 260px;
      }
    }
  </style>
</head>
<body>
<header>
  <div>
    <h1>ì•„ëì–´ ììŒ Â· ëª¨ìŒ Â· ë‹¨ì–´ í•„ê¸° ì—°ìŠµ</h1>
    <span>ê¸€ìì™€ ë‹¨ì–´ë¥¼ ì„ íƒí•˜ê³ , ìœ„ ì¹¸ì—ì„œ ë”°ë¼ ì“°ê³  ì•„ë˜ ì¹¸ì—ì„œ ì§ì ‘ ì¨ ë³´ì„¸ìš”.</span>
  </div>
</header>

<div class="container">
  <!-- ì™¼ìª½: ììŒ/ëª¨ìŒ/ë‹¨ì–´ ëª©ë¡ -->
  <aside class="sidebar">
    <div class="tab-buttons">
      <button class="tab-button active" data-tab="consonants">ììŒ</button>
      <button class="tab-button" data-tab="vowels">ëª¨ìŒ</button>
      <button class="tab-button" data-tab="words">ë‹¨ì–´</button>
    </div>
    <div class="list-title" id="listTitle">ì•„ëì–´ ììŒ (ì•ŒíŒŒë²³) ëª©ë¡</div>
    <div class="letter-grid" id="letterGrid">
      <!-- JSë¡œ ì±„ì›€ -->
    </div>
  </aside>

  <!-- ì˜¤ë¥¸ìª½: ì •ë³´ + ìº”ë²„ìŠ¤ -->
  <main class="main">
    <section class="info-panel">
      <div class="info-left">
        <div class="info-title" id="infoTitle">ê¸€ìë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.</div>
        <div class="info-detail" id="infoDetail">
          ì™¼ìª½ì—ì„œ ììŒ, ëª¨ìŒ ë˜ëŠ” ë‹¨ì–´ë¥¼ ëˆ„ë¥´ë©´ ì •ë³´ê°€ ì—¬ê¸° ë‚˜ì˜µë‹ˆë‹¤.
        </div>
        <div class="info-example" id="infoExample"></div>

        <div class="forms-row" id="formsRow">
          <span class="form-label">í˜•íƒœ ì—°ìŠµ:</span>
          <button class="form-button selected" data-form="isolated">
            ë‹¨ë…
            <span class="form-glyph" id="formIsolated">Ø§</span>
          </button>
          <button class="form-button" data-form="initial">
            ì•
            <span class="form-glyph" id="formInitial">Ø§</span>
          </button>
          <button class="form-button" data-form="medial">
            ê°€ìš´ë°
            <span class="form-glyph" id="formMedial">Ø§</span>
          </button>
          <button class="form-button" data-form="final">
            ë
            <span class="form-glyph" id="formFinal">Ø§</span>
          </button>
        </div>

        <div class="info-actions">
          <button class="btn" id="speakBtn">ë°œìŒ ë“£ê¸° ğŸ”Š</button>
        </div>
      </div>
      <div class="big-letter" id="bigLetter">Ø§</div>
    </section>

    <section class="canvas-row">
      <!-- ë”°ë¼ ì“°ê¸° -->
      <div class="canvas-card">
        <div class="canvas-header">
          <div class="canvas-title">1. ë”°ë¼ ì“°ê¸°</div>
          <div class="canvas-controls">
            ì„  ë‘ê»˜
            <input type="range" min="2" max="12" value="5" id="traceWidth" />
            <button class="btn" id="clearTrace">ì§€ìš°ê¸°</button>
          </div>
        </div>
        <div class="canvas-wrapper">
          <canvas id="traceCanvas"></canvas>
        </div>
        <div class="hint-text">
          íë¦¿í•œ ê¸€ìë‚˜ ë‹¨ì–´ë¥¼ ë³´ë©´ì„œ ëª¨ì–‘ì„ ë”°ë¼ ê·¸ë ¤ ë³´ì„¸ìš”. (ë§ˆìš°ìŠ¤ ë˜ëŠ” ì†ê°€ë½)
        </div>
      </div>

      <!-- ì§ì ‘ ì¨ ë³´ê¸° -->
      <div class="canvas-card">
        <div class="canvas-header">
          <div class="canvas-title">2. ì§ì ‘ ì¨ ë³´ê¸°</div>
          <div class="canvas-controls">
            ì„  ë‘ê»˜
            <input type="range" min="2" max="12" value="5" id="freeWidth" />
            <button class="btn" id="clearFree">ì§€ìš°ê¸°</button>
          </div>
        </div>
        <div class="canvas-wrapper">
          <canvas id="freeCanvas"></canvas>
        </div>
        <div class="hint-text">
          ë¹ˆ ì¹¸ì— ê¸°ì–µë‚˜ëŠ” ëŒ€ë¡œ ììœ ë¡­ê²Œ ì—°ìŠµí•´ ë³´ì„¸ìš”.
        </div>
      </div>
    </section>
  </main>
</div>

<script>
  // ===== ë°ì´í„°: ììŒ / ëª¨ìŒ / ë‹¨ì–´ =====
  const consonants = [
    {
      letter: "Ø§",
      name: "alif (Ø£ÙÙ„ÙÙ)",
      sound: "ê¸´ a / Ê”a",
      example: "Ø§Ù",
      exampleMeaning: "a ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø§Ù",
      forms: { isolated: "Ø§", initial: "Ø§", medial: "Ù€Ø§", final: "Ù€Ø§" }
    },
    {
      letter: "Ø¨",
      name: "bÄÊ¼ (Ø¨ÙØ§Ø¡)",
      sound: "b",
      example: "Ø¨Ù",
      exampleMeaning: "ba ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø¨Ù",
      forms: { isolated: "Ø¨", initial: "ïº‘", medial: "Ù€Ø¨Ù€", final: "Ù€Ø¨" }
    },
    {
      letter: "Øª",
      name: "tÄÊ¼ (ØªÙØ§Ø¡)",
      sound: "t",
      example: "ØªÙ",
      exampleMeaning: "ta ì†Œë¦¬(ìŒì ˆ)",
      tts: "ØªÙ",
      forms: { isolated: "Øª", initial: "ïº—", medial: "Ù€ØªÙ€", final: "Ù€Øª" }
    },
    {
      letter: "Ø«",
      name: "thÄÊ¼ (Ø«ÙØ§Ø¡)",
      sound: "th (ë¬´ì„±, ì˜ì–´ think)",
      example: "Ø«Ù",
      exampleMeaning: "tha ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø«Ù",
      forms: { isolated: "Ø«", initial: "ïº›", medial: "Ù€Ø«Ù€", final: "Ù€Ø«" }
    },
    {
      letter: "Ø¬",
      name: "jÄ«m (Ø¬ÙÙŠÙ…)",
      sound: "j / Ê¤",
      example: "Ø¬Ù",
      exampleMeaning: "ja ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø¬Ù",
      forms: { isolated: "Ø¬", initial: "ïºŸ", medial: "Ù€Ø¬Ù€", final: "Ù€Ø¬" }
    },
    {
      letter: "Ø­",
      name: "á¸¥ÄÊ¼ (Ø­ÙØ§Ø¡)",
      sound: "ê°•í•œ h (ëª©ì—ì„œ)",
      example: "Ø­Ù",
      exampleMeaning: "á¸¥a ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø­Ù",
      forms: { isolated: "Ø­", initial: "ïº£", medial: "Ù€Ø­Ù€", final: "Ù€Ø­" }
    },
    {
      letter: "Ø®",
      name: "khÄÊ¼ (Ø®ÙØ§Ø¡)",
      sound: "kh (ë…ì¼ì–´ ch ë¹„ìŠ·)",
      example: "Ø®Ù",
      exampleMeaning: "kha ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø®Ù",
      forms: { isolated: "Ø®", initial: "ïº§", medial: "Ù€Ø®Ù€", final: "Ù€Ø®" }
    },
    {
      letter: "Ø¯",
      name: "dÄl (Ø¯ÙØ§Ù„)",
      sound: "d",
      example: "Ø¯Ù",
      exampleMeaning: "da ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø¯Ù",
      forms: { isolated: "Ø¯", initial: "Ø¯", medial: "Ù€Ø¯", final: "Ù€Ø¯" }
    },
    {
      letter: "Ø°",
      name: "dhÄl (Ø°ÙØ§Ù„)",
      sound: "dh (ì˜ì–´ this ì˜ th)",
      example: "Ø°Ù",
      exampleMeaning: "dha ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø°Ù",
      forms: { isolated: "Ø°", initial: "Ø°", medial: "Ù€Ø°", final: "Ù€Ø°" }
    },
    {
      letter: "Ø±",
      name: "rÄÊ¼ (Ø±ÙØ§Ø¡)",
      sound: "êµ´ë¦¬ëŠ” r",
      example: "Ø±Ù",
      exampleMeaning: "ra ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø±Ù",
      forms: { isolated: "Ø±", initial: "Ø±", medial: "Ù€Ø±", final: "Ù€Ø±" }
    },
    {
      letter: "Ø²",
      name: "zÄy (Ø²ÙØ§ÙŠ)",
      sound: "z",
      example: "Ø²Ù",
      exampleMeaning: "za ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø²Ù",
      forms: { isolated: "Ø²", initial: "Ø²", medial: "Ù€Ø²", final: "Ù€Ø²" }
    },
    {
      letter: "Ø³",
      name: "sÄ«n (Ø³ÙÙŠÙ†)",
      sound: "s",
      example: "Ø³Ù",
      exampleMeaning: "sa ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø³Ù",
      forms: { isolated: "Ø³", initial: "ïº³", medial: "Ù€Ø³Ù€", final: "Ù€Ø³" }
    },
    {
      letter: "Ø´",
      name: "shÄ«n (Ø´ÙÙŠÙ†)",
      sound: "sh",
      example: "Ø´Ù",
      exampleMeaning: "sha ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø´Ù",
      forms: { isolated: "Ø´", initial: "ïº·", medial: "Ù€Ø´Ù€", final: "Ù€Ø´" }
    },
    {
      letter: "Øµ",
      name: "á¹£Äd (ØµÙØ§Ø¯)",
      sound: "ê°•í•œ s (emphatic)",
      example: "ØµÙ",
      exampleMeaning: "á¹£a ì†Œë¦¬(ìŒì ˆ)",
      tts: "ØµÙ",
      forms: { isolated: "Øµ", initial: "ïº»", medial: "Ù€ØµÙ€", final: "Ù€Øµ" }
    },
    {
      letter: "Ø¶",
      name: "á¸Äd (Ø¶ÙØ§Ø¯)",
      sound: "ê°•í•œ d",
      example: "Ø¶Ù",
      exampleMeaning: "á¸a ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø¶Ù",
      forms: { isolated: "Ø¶", initial: "ïº¿", medial: "Ù€Ø¶Ù€", final: "Ù€Ø¶" }
    },
    {
      letter: "Ø·",
      name: "á¹­ÄÊ¼ (Ø·ÙØ§Ø¡)",
      sound: "ê°•í•œ t",
      example: "Ø·Ù",
      exampleMeaning: "á¹­a ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø·Ù",
      forms: { isolated: "Ø·", initial: "ï»ƒ", medial: "Ù€Ø·Ù€", final: "Ù€Ø·" }
    },
    {
      letter: "Ø¸",
      name: "áº“ÄÊ¼ (Ø¸ÙØ§Ø¡)",
      sound: "ê°•í•œ dh",
      example: "Ø¸Ù",
      exampleMeaning: "áº“a ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø¸Ù",
      forms: { isolated: "Ø¸", initial: "ï»‡", medial: "Ù€Ø¸Ù€", final: "Ù€Ø¸" }
    },
    {
      letter: "Ø¹",
      name: "Ê¿ayn (Ø¹ÙÙŠÙ’Ù†)",
      sound: "ëª©ì—ì„œ ë‚˜ëŠ” ì†Œë¦¬",
      example: "Ø¹Ù",
      exampleMeaning: "Ê¿a ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø¹Ù",
      forms: { isolated: "Ø¹", initial: "ï»‹", medial: "Ù€Ø¹Ù€", final: "Ù€Ø¹" }
    },
    {
      letter: "Øº",
      name: "ghayn (ØºÙÙŠÙ’Ù†)",
      sound: "gh (í”„ë‘ìŠ¤ì–´ r ë¹„ìŠ·)",
      example: "ØºÙ",
      exampleMeaning: "gha ì†Œë¦¬(ìŒì ˆ)",
      tts: "ØºÙ",
      forms: { isolated: "Øº", initial: "ï»", medial: "Ù€ØºÙ€", final: "Ù€Øº" }
    },
    {
      letter: "Ù",
      name: "fÄÊ¼ (ÙÙØ§Ø¡)",
      sound: "f",
      example: "ÙÙ",
      exampleMeaning: "fa ì†Œë¦¬(ìŒì ˆ)",
      tts: "ÙÙ",
      forms: { isolated: "Ù", initial: "ï»“", medial: "Ù€ÙÙ€", final: "Ù€Ù" }
    },
    {
      letter: "Ù‚",
      name: "qÄf (Ù‚ÙØ§Ù)",
      sound: "ë’¤ìª½ k (q)",
      example: "Ù‚Ù",
      exampleMeaning: "qa ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ù‚Ù",
      forms: { isolated: "Ù‚", initial: "ï»—", medial: "Ù€Ù‚Ù€", final: "Ù€Ù‚" }
    },
    {
      letter: "Ùƒ",
      name: "kÄf (ÙƒÙØ§Ù)",
      sound: "k",
      example: "ÙƒÙ",
      exampleMeaning: "ka ì†Œë¦¬(ìŒì ˆ)",
      tts: "ÙƒÙ",
      forms: { isolated: "Ùƒ", initial: "ï»›", medial: "Ù€ÙƒÙ€", final: "Ù€Ùƒ" }
    },
    {
      letter: "Ù„",
      name: "lÄm (Ù„ÙØ§Ù…)",
      sound: "l",
      example: "Ù„Ù",
      exampleMeaning: "la ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ù„Ù",
      forms: { isolated: "Ù„", initial: "ï»Ÿ", medial: "Ù€Ù„Ù€", final: "Ù€Ù„" }
    },
    {
      letter: "Ù…",
      name: "mÄ«m (Ù…ÙÙŠÙ…)",
      sound: "m",
      example: "Ù…Ù",
      exampleMeaning: "ma ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ù…Ù",
      forms: { isolated: "Ù…", initial: "ï»£", medial: "Ù€Ù…Ù€", final: "Ù€Ù…" }
    },
    {
      letter: "Ù†",
      name: "nÅ«n (Ù†ÙÙˆÙ†)",
      sound: "n",
      example: "Ù†Ù",
      exampleMeaning: "na ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ù†Ù",
      forms: { isolated: "Ù†", initial: "ï»§", medial: "Ù€Ù†Ù€", final: "Ù€Ù†" }
    },
    {
      letter: "Ù‡",
      name: "hÄÊ¼ (Ù‡ÙØ§Ø¡)",
      sound: "h",
      example: "Ù‡Ù",
      exampleMeaning: "ha ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ù‡Ù",
      forms: { isolated: "Ù‡", initial: "ï»«", medial: "Ù€Ù‡Ù€", final: "Ù€Ù‡" }
    },
    {
      letter: "Ùˆ",
      name: "wÄw (ÙˆÙØ§Ùˆ)",
      sound: "w / ê¸´ u",
      example: "ÙˆÙ",
      exampleMeaning: "wa ì†Œë¦¬(ìŒì ˆ)",
      tts: "ÙˆÙ",
      forms: { isolated: "Ùˆ", initial: "Ùˆ", medial: "Ù€Ùˆ", final: "Ù€Ùˆ" }
    },
    {
      letter: "ÙŠ",
      name: "yÄÊ¼ (ÙŠÙØ§Ø¡)",
      sound: "y / ê¸´ i",
      example: "ÙŠÙ",
      exampleMeaning: "ya ì†Œë¦¬(ìŒì ˆ)",
      tts: "ÙŠÙ",
      forms: { isolated: "ÙŠ", initial: "ï»³", medial: "Ù€ÙŠÙ€", final: "Ù€ÙŠ" }
    }
  ];

  const vowels = [
    {
      letter: "Ù",
      name: "fatá¸¥a (ÙÙØªÙ’Ø­ÙØ©)",
      sound: "a",
      desc: "ììŒ ìœ„ì— ì“°ëŠ” ì§§ì€ a ì†Œë¦¬",
      example: "Ø¨Ù",
      exampleMeaning: "ba ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø¨Ù"
    },
    {
      letter: "Ù",
      name: "kasra (ÙƒÙØ³Ù’Ø±ÙØ©)",
      sound: "i",
      desc: "ììŒ ì•„ë˜ì— ì“°ëŠ” ì§§ì€ i ì†Œë¦¬",
      example: "Ø¨Ù",
      exampleMeaning: "bi ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø¨Ù"
    },
    {
      letter: "Ù",
      name: "á¸amma (Ø¶ÙÙ…Ù‘ÙØ©)",
      sound: "u",
      desc: "ììŒ ìœ„ì— ì“°ëŠ” ì§§ì€ u ì†Œë¦¬",
      example: "Ø¨Ù",
      exampleMeaning: "bu ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø¨Ù"
    },
    {
      letter: "Ù’",
      name: "sukÅ«n (Ø³ÙÙƒÙÙˆÙ†)",
      sound: "ììŒë§Œ ë°œìŒ",
      desc: "ë’¤ì— ëª¨ìŒ ì—†ìŒ",
      example: "Ø¨Ù’",
      exampleMeaning: "b ì†Œë¦¬(ììŒë§Œ)",
      tts: "Ø¨Ù’"
    },
    {
      letter: "Ù‘",
      name: "shadda (Ø´ÙØ¯Ù‘ÙØ©)",
      sound: "ììŒì´ 2ë²ˆ",
      desc: "ììŒì„ ê²¹ì³ ë°œìŒ",
      example: "Ø¨Ù‘",
      exampleMeaning: "bb ì†Œë¦¬(ììŒ ê²¹ì¹¨)",
      tts: "Ø¨Ù‘"
    },
    {
      letter: "Ù‹",
      name: "tanwÄ«n fatá¸¥ (ØªÙÙ†Ù’ÙˆÙÙŠÙ† ÙÙØªÙ’Ø­)",
      sound: "an",
      desc: "ë‹¨ì–´ ëì—ì„œ an ì†Œë¦¬",
      example: "Ø¨Ù‹Ø§",
      exampleMeaning: "ban ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø¨Ù‹Ø§"
    },
    {
      letter: "Ù",
      name: "tanwÄ«n kasr (ØªÙÙ†Ù’ÙˆÙÙŠÙ† ÙƒÙØ³Ù’Ø±)",
      sound: "in",
      desc: "ë‹¨ì–´ ëì—ì„œ in ì†Œë¦¬",
      example: "Ø¨Ù",
      exampleMeaning: "bin ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø¨Ù"
    },
    {
      letter: "ÙŒ",
      name: "tanwÄ«n á¸amm (ØªÙÙ†Ù’ÙˆÙÙŠÙ† Ø¶ÙÙ…Ù‘)",
      sound: "un",
      desc: "ë‹¨ì–´ ëì—ì„œ un ì†Œë¦¬",
      example: "Ø¨ÙŒ",
      exampleMeaning: "bun ì†Œë¦¬(ìŒì ˆ)",
      tts: "Ø¨ÙŒ"
    }
  ];

  // ìƒ‰ê¹” / ë‚ ì”¨ / ê³¼ì¼ / ì•¼ì±„ / êµí†µìˆ˜ë‹¨ ë‹¨ì–´ë“¤
  const words = [
    // ìƒ‰ê¹”
    {
      letter: "Ø£ÙØ­Ù’Ù…ÙØ±Ù",
      meaning: "ë¹¨ê°„ìƒ‰",
      category: "ìƒ‰ê¹”",
      tts: "Ø£ÙØ­Ù’Ù…ÙØ±Ù"
    },
    {
      letter: "Ø£ÙØ²Ù’Ø±ÙÙ‚Ù",
      meaning: "íŒŒë€ìƒ‰",
      category: "ìƒ‰ê¹”",
      tts: "Ø£ÙØ²Ù’Ø±ÙÙ‚Ù"
    },
    {
      letter: "Ø£ÙØµÙ’ÙÙØ±Ù",
      meaning: "ë…¸ë€ìƒ‰",
      category: "ìƒ‰ê¹”",
      tts: "Ø£ÙØµÙ’ÙÙØ±Ù"
    },
    {
      letter: "Ø£ÙØ®Ù’Ø¶ÙØ±Ù",
      meaning: "ì´ˆë¡ìƒ‰",
      category: "ìƒ‰ê¹”",
      tts: "Ø£ÙØ®Ù’Ø¶ÙØ±Ù"
    },
    {
      letter: "Ø£ÙØ¨Ù’ÙŠÙØ¶Ù",
      meaning: "í•˜ì–€ìƒ‰",
      category: "ìƒ‰ê¹”",
      tts: "Ø£ÙØ¨Ù’ÙŠÙØ¶Ù"
    },
    {
      letter: "Ø£ÙØ³Ù’ÙˆÙØ¯Ù",
      meaning: "ê²€ì€ìƒ‰",
      category: "ìƒ‰ê¹”",
      tts: "Ø£ÙØ³Ù’ÙˆÙØ¯Ù"
    },

    // ë‚ ì”¨
    {
      letter: "Ù…ÙØ·ÙØ±ÙŒ",
      meaning: "ë¹„",
      category: "ë‚ ì”¨",
      tts: "Ù…ÙØ·ÙØ±ÙŒ"
    },
    {
      letter: "Ø«ÙÙ„Ù’Ø¬ÙŒ",
      meaning: "ëˆˆ (snow)",
      category: "ë‚ ì”¨",
      tts: "Ø«ÙÙ„Ù’Ø¬ÙŒ"
    },
    {
      letter: "Ø´ÙÙ…Ù’Ø³ÙŒ",
      meaning: "í•´, í–‡ë¹›",
      category: "ë‚ ì”¨",
      tts: "Ø´ÙÙ…Ù’Ø³ÙŒ"
    },
    {
      letter: "Ø±ÙÙŠØ­ÙŒ",
      meaning: "ë°”ëŒ",
      category: "ë‚ ì”¨",
      tts: "Ø±ÙÙŠØ­ÙŒ"
    },
    {
      letter: "Ø¬ÙÙˆÙ‘ÙŒ Ø­ÙØ§Ø±Ù‘ÙŒ",
      meaning: "ë”ìš´ ë‚ ì”¨",
      category: "ë‚ ì”¨",
      tts: "Ø¬ÙÙˆÙ‘ÙŒ Ø­ÙØ§Ø±Ù‘ÙŒ"
    },
    {
      letter: "Ø¬ÙÙˆÙ‘ÙŒ Ø¨ÙØ§Ø±ÙØ¯ÙŒ",
      meaning: "ì¶”ìš´ ë‚ ì”¨",
      category: "ë‚ ì”¨",
      tts: "Ø¬ÙÙˆÙ‘ÙŒ Ø¨ÙØ§Ø±ÙØ¯ÙŒ"
    },

    // ê³¼ì¼
    {
      letter: "ØªÙÙÙ‘ÙØ§Ø­ÙØ©ÙŒ",
      meaning: "ì‚¬ê³¼",
      category: "ê³¼ì¼",
      tts: "ØªÙÙÙ‘ÙØ§Ø­ÙØ©ÙŒ"
    },
    {
      letter: "Ù…ÙÙˆÙ’Ø²ÙØ©ÙŒ",
      meaning: "ë°”ë‚˜ë‚˜",
      category: "ê³¼ì¼",
      tts: "Ù…ÙÙˆÙ’Ø²ÙØ©ÙŒ"
    },
    {
      letter: "Ø¨ÙØ±Ù’ØªÙÙ‚ÙØ§Ù„ÙØ©ÙŒ",
      meaning: "ì˜¤ë Œì§€",
      category: "ê³¼ì¼",
      tts: "Ø¨ÙØ±Ù’ØªÙÙ‚ÙØ§Ù„ÙØ©ÙŒ"
    },
    {
      letter: "Ø¹ÙÙ†ÙØ¨ÙŒ",
      meaning: "í¬ë„",
      category: "ê³¼ì¼",
      tts: "Ø¹ÙÙ†ÙØ¨ÙŒ"
    },
    {
      letter: "ÙÙØ±ÙØ§ÙˆÙÙ„ÙØ©ÙŒ",
      meaning: "ë”¸ê¸°",
      category: "ê³¼ì¼",
      tts: "ÙÙØ±ÙØ§ÙˆÙÙ„ÙØ©ÙŒ"
    },

    // ì•¼ì±„
    {
      letter: "Ø¬ÙØ²ÙØ±ÙŒ",
      meaning: "ë‹¹ê·¼",
      category: "ì•¼ì±„",
      tts: "Ø¬ÙØ²ÙØ±ÙŒ"
    },
    {
      letter: "Ø·ÙÙ…ÙØ§Ø·ÙÙ…Ù",
      meaning: "í† ë§ˆí† ",
      category: "ì•¼ì±„",
      tts: "Ø·ÙÙ…ÙØ§Ø·ÙÙ…Ù"
    },
    {
      letter: "Ø¨ÙØ·ÙØ§Ø·ÙØ³Ù",
      meaning: "ê°ì",
      category: "ì•¼ì±„",
      tts: "Ø¨ÙØ·ÙØ§Ø·ÙØ³Ù"
    },
    {
      letter: "Ø®ÙÙŠÙØ§Ø±ÙŒ",
      meaning: "ì˜¤ì´",
      category: "ì•¼ì±„",
      tts: "Ø®ÙÙŠÙØ§Ø±ÙŒ"
    },
    {
      letter: "Ø¨ÙØµÙÙ„ÙŒ",
      meaning: "ì–‘íŒŒ",
      category: "ì•¼ì±„",
      tts: "Ø¨ÙØµÙÙ„ÙŒ"
    },

    // êµí†µìˆ˜ë‹¨
    {
      letter: "Ø³ÙÙŠÙ‘ÙØ§Ø±ÙØ©ÙŒ",
      meaning: "ìë™ì°¨",
      category: "êµí†µìˆ˜ë‹¨",
      tts: "Ø³ÙÙŠÙ‘ÙØ§Ø±ÙØ©ÙŒ"
    },
    {
      letter: "Ø­ÙØ§ÙÙÙ„ÙØ©ÙŒ",
      meaning: "ë²„ìŠ¤",
      category: "êµí†µìˆ˜ë‹¨",
      tts: "Ø­ÙØ§ÙÙÙ„ÙØ©ÙŒ"
    },
    {
      letter: "Ù‚ÙØ·ÙØ§Ø±ÙŒ",
      meaning: "ê¸°ì°¨",
      category: "êµí†µìˆ˜ë‹¨",
      tts: "Ù‚ÙØ·ÙØ§Ø±ÙŒ"
    },
    {
      letter: "Ù…ÙØªÙ’Ø±ÙÙˆ",
      meaning: "ì§€í•˜ì² ",
      category: "êµí†µìˆ˜ë‹¨",
      tts: "Ù…ÙØªÙ’Ø±ÙÙˆ"
    },
    {
      letter: "Ø¯ÙØ±Ù‘ÙØ§Ø¬ÙØ©ÙŒ",
      meaning: "ìì „ê±°",
      category: "êµí†µìˆ˜ë‹¨",
      tts: "Ø¯ÙØ±Ù‘ÙØ§Ø¬ÙØ©ÙŒ"
    },
    {
      letter: "Ø·ÙØ§Ø¦ÙØ±ÙØ©ÙŒ",
      meaning: "ë¹„í–‰ê¸°",
      category: "êµí†µìˆ˜ë‹¨",
      tts: "Ø·ÙØ§Ø¦ÙØ±ÙØ©ÙŒ"
    }
  ];

  let currentTab = "consonants";
  let currentLetterObj = null;
  let currentForm = "isolated";

  const tabButtons = document.querySelectorAll(".tab-button");
  const letterGrid = document.getElementById("letterGrid");
  const listTitle = document.getElementById("listTitle");
  const infoTitle = document.getElementById("infoTitle");
  const infoDetail = document.getElementById("infoDetail");
  const infoExample = document.getElementById("infoExample");
  const bigLetter = document.getElementById("bigLetter");

  const formsRow = document.getElementById("formsRow");
  const formButtons = document.querySelectorAll(".form-button");
  const formIsolated = document.getElementById("formIsolated");
  const formInitial = document.getElementById("formInitial");
  const formMedial = document.getElementById("formMedial");
  const formFinal = document.getElementById("formFinal");
  const speakBtn = document.getElementById("speakBtn");

  function getCurrentGlyph() {
    if (!currentLetterObj) return "";
    if (currentTab === "consonants" && currentLetterObj.forms) {
      return currentLetterObj.forms[currentForm] || currentLetterObj.letter;
    }
    return currentLetterObj.letter;
  }

  function updateFormGlyphs(item) {
    if (!item || currentTab !== "consonants") return;
    const f = item.forms || {
      isolated: item.letter,
      initial: item.letter,
      medial: item.letter,
      final: item.letter
    };
    formIsolated.textContent = f.isolated;
    formInitial.textContent = f.initial;
    formMedial.textContent = f.medial;
    formFinal.textContent = f.final;
  }

  function updateInfoPanel(item) {
    const glyph = getCurrentGlyph();
    bigLetter.textContent = glyph;

    if (currentTab === "consonants") {
      infoTitle.textContent = item.name;
      infoDetail.textContent = "ë°œìŒ: " + item.sound;
      if (item.example) {
        infoExample.innerHTML =
          'ì˜ˆì‹œ: <span>' +
          item.example +
          "</span> â€” " +
          (item.exampleMeaning || "");
      } else {
        infoExample.textContent = "";
      }
    } else if (currentTab === "vowels") {
      infoTitle.textContent = item.name;
      infoDetail.textContent = `ë°œìŒ: ${item.sound} â€” ${item.desc}`;
      if (item.example) {
        infoExample.innerHTML =
          'ì˜ˆì‹œ: <span>' +
          item.example +
          "</span> â€” " +
          (item.exampleMeaning || "");
      } else {
        infoExample.textContent = "";
      }
    } else if (currentTab === "words") {
      infoTitle.textContent = item.letter;
      infoDetail.textContent = `ëœ»: ${item.meaning} â€” (${item.category})`;
      infoExample.textContent = "";
    }
  }

  function selectLetter(item) {
    currentLetterObj = item;
    if (currentTab === "consonants") {
      updateFormGlyphs(item);
    }
    updateInfoPanel(item);
    drawGuideLetter();
    clearCanvas(traceCtx, traceCanvas);
    clearCanvas(freeCtx, freeCanvas);
  }

  function renderLetterGrid() {
    letterGrid.innerHTML = "";
    let data;
    if (currentTab === "consonants") data = consonants;
    else if (currentTab === "vowels") data = vowels;
    else data = words;

    if (currentTab === "consonants") {
      listTitle.textContent = "ì•„ëì–´ ììŒ (ì•ŒíŒŒë²³) ëª©ë¡";
    } else if (currentTab === "vowels") {
      listTitle.textContent = "ì•„ëì–´ ëª¨ìŒ ê¸°í˜¸ (í•˜ë¼ì¹´íŠ¸) ëª©ë¡";
    } else {
      listTitle.textContent =
        "ë‹¨ì–´ ì—°ìŠµ (ìƒ‰ê¹” Â· ë‚ ì”¨ Â· ê³¼ì¼ Â· ì•¼ì±„ Â· êµí†µìˆ˜ë‹¨)";
    }

    // ììŒì¼ ë•Œë§Œ í˜•íƒœ ì—°ìŠµ ë³´ì´ê¸°
    formsRow.style.display = currentTab === "consonants" ? "flex" : "none";

    data.forEach((item, index) => {
      const card = document.createElement("button");
      card.className = "letter-card";
      card.dataset.index = index;

      const symbol = document.createElement("div");
      symbol.className = "letter-symbol";
      symbol.textContent = item.letter;

      const name = document.createElement("div");
      name.className = "letter-name";

      if (currentTab === "consonants") {
        name.textContent = item.name;
      } else if (currentTab === "vowels") {
        name.textContent = item.name.split(" ")[0] + " / " + item.sound;
      } else {
        name.textContent = item.meaning + " Â· " + item.category;
      }

      card.appendChild(symbol);
      card.appendChild(name);

      card.addEventListener("click", () => {
        document
          .querySelectorAll(".letter-card")
          .forEach((c) => c.classList.remove("selected"));
        card.classList.add("selected");
        currentForm = "isolated";
        formButtons.forEach((b) => b.classList.remove("selected"));
        formButtons[0].classList.add("selected");
        selectLetter(item);
      });

      letterGrid.appendChild(card);
    });

    // ê¸°ë³¸ ì„ íƒ: ì²« í•­ëª©
    if (data.length > 0) {
      const first = data[0];
      currentLetterObj = first;
      currentForm = "isolated";
      formButtons.forEach((b) => b.classList.remove("selected"));
      formButtons[0].classList.add("selected");
      if (currentTab === "consonants") {
        updateFormGlyphs(first);
      }
      updateInfoPanel(first);
      if (letterGrid.firstChild) {
        letterGrid.firstChild.classList.add("selected");
      }
      drawGuideLetter();
      clearCanvas(traceCtx, traceCanvas);
      clearCanvas(freeCtx, freeCanvas);
    }
  }

  tabButtons.forEach((btn) => {
    btn.addEventListener("click", () => {
      if (btn.dataset.tab === currentTab) return;
      currentTab = btn.dataset.tab;
      tabButtons.forEach((b) => b.classList.remove("active"));
      btn.classList.add("active");
      renderLetterGrid();
    });
  });

  // í˜•íƒœ ë²„íŠ¼
  formButtons.forEach((btn) => {
    btn.addEventListener("click", () => {
      if (!currentLetterObj) return;
      currentForm = btn.dataset.form;
      formButtons.forEach((b) => b.classList.remove("selected"));
      btn.classList.add("selected");
      updateInfoPanel(currentLetterObj);
      drawGuideLetter();
    });
  });

  // ë°œìŒ(TTS) ë²„íŠ¼
  speakBtn.addEventListener("click", () => {
    if (!currentLetterObj) return;
    if (!("speechSynthesis" in window)) {
      alert("ë¸Œë¼ìš°ì €ê°€ ìŒì„± í•©ì„±ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
      return;
    }
    const text =
      currentLetterObj.tts ||
      currentLetterObj.example ||
      currentLetterObj.letter;
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = "ar-SA";
    window.speechSynthesis.cancel();
    window.speechSynthesis.speak(utter);
  });

  // ìº”ë²„ìŠ¤ ì„¸íŒ…
  const traceCanvas = document.getElementById("traceCanvas");
  const freeCanvas = document.getElementById("freeCanvas");
  const traceCtx = traceCanvas.getContext("2d");
  const freeCtx = freeCanvas.getContext("2d");

  function resizeCanvas() {
    [traceCanvas, freeCanvas].forEach((c) => {
      const rect = c.getBoundingClientRect();
      const dpr = window.devicePixelRatio || 1;
      c.width = rect.width * dpr;
      c.height = rect.height * dpr;
      const ctx = c.getContext("2d");
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      ctx.lineCap = "round";
      ctx.lineJoin = "round";
      ctx.strokeStyle = "#111827";
      ctx.lineWidth = 5;
    });

    drawGuideLetter();
  }

  function clearCanvas(ctx, canvas) {
    const rect = canvas.getBoundingClientRect();
    ctx.clearRect(0, 0, rect.width, rect.height);
    if (canvas === traceCanvas) {
      drawGuideLetter();
    }
  }

  function drawGuideLetter() {
    if (!currentLetterObj) return;
    const ctx = traceCtx;
    const canvas = traceCanvas;
    const rect = canvas.getBoundingClientRect();
    ctx.clearRect(0, 0, rect.width, rect.height);

    const guide = getCurrentGlyph();

    ctx.save();
    ctx.globalAlpha = 0.12;
    ctx.fillStyle = "#111827";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";

    const size = Math.min(rect.width, rect.height) * 0.55;
    ctx.font =
      "normal " +
      size +
      "px 'Noto Naskh Arabic','Scheherazade New','Amiri','Times New Roman',serif";
    ctx.fillText(guide, rect.width / 2, rect.height / 2);
    ctx.restore();
  }

  window.addEventListener("resize", resizeCanvas);

  // ê·¸ë¦¬ê¸° ë¡œì§
  function enableDrawing(canvas, ctx, widthInput) {
    let drawing = false;
    let lastX = 0;
    let lastY = 0;

    function getPos(e) {
      const rect = canvas.getBoundingClientRect();
      const point =
        e.touches && e.touches[0]
          ? e.touches[0]
          : e.changedTouches && e.changedTouches[0]
          ? e.changedTouches[0]
          : e;
      return {
        x: point.clientX - rect.left,
        y: point.clientY - rect.top
      };
    }

    function start(e) {
      e.preventDefault();
      drawing = true;
      const pos = getPos(e);
      lastX = pos.x;
      lastY = pos.y;
    }

    function move(e) {
      if (!drawing) return;
      e.preventDefault();
      const pos = getPos(e);
      ctx.beginPath();
      ctx.moveTo(lastX, lastY);
      ctx.lineTo(pos.x, pos.y);
      ctx.stroke();
      lastX = pos.x;
      lastY = pos.y;
    }

    function end(e) {
      if (!drawing) return;
      e.preventDefault();
      drawing = false;
    }

    canvas.addEventListener("mousedown", start);
    canvas.addEventListener("mousemove", move);
    window.addEventListener("mouseup", end);

    canvas.addEventListener("touchstart", start, { passive: false });
    canvas.addEventListener("touchmove", move, { passive: false });
    canvas.addEventListener("touchend", end, { passive: false });
    canvas.addEventListener("touchcancel", end, { passive: false });

    if (widthInput) {
      widthInput.addEventListener("input", () => {
        ctx.lineWidth = Number(widthInput.value);
      });
    }
  }

  const traceWidthInput = document.getElementById("traceWidth");
  const freeWidthInput = document.getElementById("freeWidth");
  const clearTraceBtn = document.getElementById("clearTrace");
  const clearFreeBtn = document.getElementById("clearFree");

  setTimeout(() => {
    resizeCanvas();
    enableDrawing(traceCanvas, traceCtx, traceWidthInput);
    enableDrawing(freeCanvas, freeCtx, freeWidthInput);
  }, 0);

  clearTraceBtn.addEventListener("click", () =>
    clearCanvas(traceCtx, traceCanvas)
  );
  clearFreeBtn.addEventListener("click", () =>
    clearCanvas(freeCtx, freeCanvas)
  );

  // ì²˜ìŒ ë Œë”ë§
  renderLetterGrid();
</script>
</body>
</html>
